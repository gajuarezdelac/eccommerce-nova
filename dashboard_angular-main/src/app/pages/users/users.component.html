
<nz-spin [nzSpinning]="isLoadingGeneral">

  
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
      <a data-abc="true">
          <i class="fa fa-home"></i>
      </a>
  </li>
    <li class="breadcrumb-item"> Administración </li>
    <li class="breadcrumb-item active" aria-current="page"> Usuarios </li>
  </ol>
</nav>

  
<form
  nz-form
  [nzLayout]="'vertical'"
  [formGroup]="validateForm" 
  class="login-form" 
  (ngSubmit)="submitForm()"
>  
  <div nz-row [nzGutter]="24">
    <div nz-col class="gutter-row" [nzSpan]="8"><div class="inner-box">
      <nz-form-item class="input-content" > 
        <nz-form-label [nzSpan]="6" nzFor="email"> Nombre </nz-form-label>
        <nz-form-control nzErrorTip="Campo requerido">
          <nz-input-group nzPrefixIcon="audit">
            <input type="text" nz-input formControlName="names" placeholder="Busqueda por username, nombre o apellidos" />
          </nz-input-group>

        </nz-form-control>
      </nz-form-item>
    </div></div>

    <div nz-col class="gutter-row"   [nzSpan]="8"><div class="inner-box">            
      <nz-form-item class="input-content" > 
        <nz-form-label [nzSpan]="6" nzFor="email">Apellidos </nz-form-label>
        <nz-form-control nzErrorTip="Campo requerido">
          <nz-input-group nzPrefixIcon="audit">
            <input type="text" nz-input formControlName="surnames" placeholder="Busqueda por username, nombre o apellidos" />
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>
    </div></div>

    
    <div nz-col class="gutter-row" [nzSpan]="8"><div class="inner-box">            
      <nz-form-item class="input-content" > 
        <nz-form-label [nzSpan]="6" nzFor="email">E-mail</nz-form-label>
        <nz-form-control nzErrorTip="Campo requerido">
          <nz-input-group nzPrefixIcon="user">
            <input type="text" nz-input formControlName="username" placeholder="Busqueda por username, nombre o apellidos" />
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>
    </div></div>

      </div>
            <div nz-row [nzGutter]="8">
          <div nz-col class="gutter-row" align="left"  [nzSpan]="12"><div class="inner-box">            
          <a class="btn btn-success" (click)="generateExcel()" ><i class="fas fa-file-excel"></i>  Generar </a>
          </div></div>

          <div nz-col class="gutter-row" align="right"  [nzSpan]="12"><div class="inner-box">            
            <button class="btn btn-primary"> <i class="fas fa-search"></i>  Realizar busqueda </button>
            </div></div>
        </div>

      </form>   

      <br>

    
      <nz-table  
      #fixedTable
      #headerTable
      [nzData]="data"
      [nzScroll]="{ y: '240px' }"
      nzShowPagination
      [nzPageSizeOptions]="[10, 20, 30]"
      nzShowSizeChanger
      [nzPageSize]="pageSize"
      [nzPageIndex]="current"
      [nzFrontPagination]="false"
      [nzTotal]="total"
      [nzLoading]="isLoadingTable"
      (nzPageSizeChange)="changePageSize($event)"
      (nzPageIndexChange)="changeCurrentPage($event)"
      >
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Apellidos</th>
          <th>Email</th>
          <th>Estatus</th>
          <th nzRight nzAlign="center" nzWidth="140px">Acciones</th>
        </tr>
      </thead>
        
      <tbody>
        <tr *ngFor="let data of headerTable.data">
          <td>{{ data.names }}</td>
          <td>{{ data.surnames }}</td>
          <td>{{ data.username }}</td>
          <td>{{ data.gender }}</td>
          <td nzRight nzAlign="center">
            <nz-space>
              <button nz-button nzShape="circle" nzType="text">
                <i nz-icon nzTheme="twotone"  (click)="openViewDrawer(data)" [nzTwotoneColor]="'#08a000'" nzType="eye"></i>
              </button>

              <button nz-button nzShape="circle" nzType="text">
                <i nz-icon nzTheme="twotone"  (click)="openEditDrawer(data)" [nzTwotoneColor]="'#a31600'" nzType="edit"></i>
              </button>

              <button nz-button nzShape="circle" nzType="text">
                <i nz-icon nzTheme="twotone"  (click)="showDeleteConfirm(data)" [nzTwotoneColor]="'#a31600'" nzType="delete"></i>
              </button>

            </nz-space>
          </td>
    
        </tr>
      </tbody>
      </nz-table>
</nz-spin>


<!-- view drawer -->

<nz-drawer
[nzWidth]="540"
[nzClosable]="false"
[nzVisible]="visibleDrawer"
nzPlacement="right"
nzTitle="{{ viewElement?.names }} {{viewElement?.surnames}}"
(nzOnClose)="closeViewDrawer()"
>
<ng-container *nzDrawerContent>
 <nz-spin [nzSpinning]="isLoadingDrawer">

  <nz-descriptions [nzColumn]="2" nzTitle="Asunto: {{viewElement?.username}}">
    <nz-descriptions-item nzTitle="Nombre " [nzSpan]="2">{{viewElement?.names}}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Apellidos " [nzSpan]="2"> {{viewElement?.surnames}}  </nz-descriptions-item>
    <nz-descriptions-item nzTitle="Username" [nzSpan]="2"> {{viewElement?.username}} </nz-descriptions-item>
    <nz-descriptions-item nzTitle="Fecha de nacimiento" [nzSpan]="2">{{ viewElement?.dateOfBirth }}</nz-descriptions-item>
    
    <nz-descriptions-item nzTitle="Número telefonico " [nzSpan]="2">{{viewElement?.numberPhone}}</nz-descriptions-item>
    <nz-descriptions-item nzTitle="Genero " [nzSpan]="2"> {{ viewElement?.gender }} </nz-descriptions-item>
    <nz-descriptions-item nzTitle="Fecha de registro" [nzSpan]="2"> {{viewElement?.joinDate}} </nz-descriptions-item>
    <nz-descriptions-item nzTitle="Ultimo acceso" [nzSpan]="2">{{ viewElement?.lastLoginDateDisplay }}</nz-descriptions-item>
  </nz-descriptions>

 </nz-spin>
</ng-container>
</nz-drawer>

  <!-- edit drawer -->

  <nz-drawer
  [nzWidth]="540"
  [nzClosable]="false"
  [nzVisible]="visibleEditDrawer"
  nzPlacement="right"
  nzTitle="Editar usuario"
  (nzOnClose)="closeEditDrawer()"
  [nzFooter]="footer"
>
  <ng-container *nzDrawerContent>
   <nz-spin [nzSpinning]="isLoadingDrawer">
  
    <nz-descriptions [nzColumn]="2" nzTitle="Asunto: {{viewElement?.username}}">
      <nz-descriptions-item nzTitle="Enviado por " [nzSpan]="2">{{viewElement?.username}}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="Fecha " [nzSpan]="2">  </nz-descriptions-item>
      <nz-descriptions-item nzTitle="ID " [nzSpan]="2"> {{viewElement?.username}} </nz-descriptions-item>
      <nz-descriptions-item nzTitle="Mensaje" [nzSpan]="2">
        {{ viewElement?.username }}
      </nz-descriptions-item>
    </nz-descriptions>

   </nz-spin>
  </ng-container>
  
  <ng-template #footer>
    <div style="float: right">
      <button nz-button form="ngForm" nzType="primary">Guardar</button>
    </div>
  </ng-template>

</nz-drawer>




